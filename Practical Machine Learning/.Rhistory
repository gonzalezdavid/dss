setwd("~/Documents/Training/Coursera/Data Science Specialization/Practical Machine Learning")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
library(caret)
install.packages("caret")
install.packages("caret")
install.packages("rpart")
install.packages("rpart.plot")
install.packages("RColorBrewer")
install.packages("rattle")
install.packages("e1071")
install.packages("randomForest")
library(caret)
library(rpart)
library(rpart.plot)
library(RColorBrewer)
library(rattle)
library(e1071)
library(randomForest)
set.seed(1)
training.file <- "data/pml-training.csv"
testing.file <- "data/pml-testing.csv"
training.data.raw <- read.csv(training.file, na.strings = c("NA","#DIV/0!",""))
testing.data.raw <- read.csv(testing.file, na.strings = c("NA","#DIV/0!",""))
training.data.clean <- training.data.raw[,8:length(colnames(train.data.raw))]
training.data.clean <- training.data.raw[,8:length(colnames(training.data.raw))]
testing.data.clean <- testing.data.raw[,8:length(colnames(testing.data.raw))]
training.data.clean <- training.data.clean[, colSums(is.na(training.data.clean)) == 0]
testing.data.clean <- testing.data.clean[, colSums(is.na(testing.data.clean)) == 0]
nzv <- nearZeroVar(training.data.clean,saveMetrics=TRUE)
View(nzv)
zero.var.ind <- sum(nzv$nzv)
if ((zero.var.ind>0)) {
training.data.clean <- training.data.clean[,nzv$nzv==FALSE]
}
in.training <- createDataPartition(training.data.clean$classe, p=0.70, list=F)
training.data.final <- training.data.clean[in.training, ]
validate.data.final <- training.data.clean[-in.training, ]
View(validate.data.final)
control.parms <- trainControl(method="cv", 5)
rf.model <- train(classe ~ ., data=training.data.final, method="rf",
trControl=control.parms, ntree=251)
rf.model
unlink('README_cache', recursive = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(rpart)
library(rpart.plot)
library(RColorBrewer)
library(rattle)
library(e1071)
library(randomForest)
set.seed(1)
training.file <- "data/pml-training.csv"
testing.file <- "data/pml-testing.csv"
training.data.raw <- read.csv(training.file, na.strings = c("NA","#DIV/0!",""))
testing.data.raw <- read.csv(testing.file, na.strings = c("NA","#DIV/0!",""))
rf.predict <- predict(rf.model, validate.data.final)
confusionMatrix(validate.data.final$classe, rf.predict)
accuracy <- postResample(rf.predict, validate.data.final$classe)
acc.out <- accuracy[1]
overall.ose <-
1 - as.numeric(confusionMatrix(validate.data.final$classe, rf.predict)
$overall[1])
View(training.data.clean)
randomforest.prediction <- predict(randomforest.model, validate.data.final)
rf.predict <- predict(rf.model, validate.data.final)
confusionMatrix(validate.data.final$classe, rf.predict)
accuracy <- postResample(rf.predict, validate.data.final$classe)
acc.out <- accuracy[1]
overall.ose <-
1 - as.numeric(confusionMatrix(validate.data.final$classe, rf.predict)
$overall[1])
results
results <- predict(rf.model,
test.data.clean1[, -length(names(test.data.clean1))])
results <- predict(rf.model,
testing.data.clean[, -length(names(testing.data.clean))])
results
treeModel <- rpart(classe ~ ., data=training.data.final, method="class")
fancyRpartPlot(treeModel)
